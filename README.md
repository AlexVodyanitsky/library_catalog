## Проблемы хранения данных в оперативной памяти

- Нестабильность: Все данные теряются при перезапуске приложения
- Отсутствие долговременного хранения: Нельзя использовать для хранения между сессиями
- Неудобство масштабирования: Подходит только для одиночных инстансов, не для распределенных систем
- Нет поддержки конкурентного доступа: Потенциальные race conditions без синхронизации

---

## Файловое хранение

### Преимущества:
- Простая реализация — без необходимости в отдельной БД
- Чтение/запись легко реализуются с помощью стандартных библиотек Python
- Подходит для локальной отладки и тестов

### Недостатки:
- Низкая производительность при большом объеме данных (особенно при частых операциях чтения/записи)
- Нет встроенной поддержки транзакций и конкурентного доступа.
- Требуется чтение/перезапись всего файла при любом изменении
- Проблемы с масштабированием

---

## Хранение в базе данных PostgreSQL

### Преимущества:
- Поддержка транзакций, блокировок и конкурентного доступа
- Гибкая структура 
- Высокая производительность
- Поддержка индексов и возможность сложных запросов (SQL)

### Недостатки:
- Требует настройки
- Более сложная инфраструктура
- Может быть избыточной для совсем простых проектов

---

## Внешние хранилища

### Преимущества:
- Нет необходимости в собственной БД
- Удалённый доступ
- Удобно для хранения архивов и конфигураций

### Недостатки:
- Ограничения API и скорости
- Доверяем безопасность данных стороннему сервису
- Нет контроля над инфраструктурой

---


## Проблемы конкурентного доступа к данным

- Потеря данных: Обновления одного пользователя могут быть перезаписаны другим без учёта предыдущих изменений.
- Повреждённые или неполные данные: Если операция записи прерывается (например, приложение аварийно завершилось), файл может остаться в неполном или неконсистентном состоянии.
- Взаимная блокировка (Deadlock): При неправильном использовании блокировок процессы могут навсегда ждать друг друга, создавая зависания.

В БД:
- Грязное чтение - чтение незафиксированных изменений другой транзакции
- Неповторяющееся чтение: повторное чтение тех же данных возвращает другой результат, потому что другая транзакция изменила эти данные между запросами.
- Фантомное чтение:при повторном запросе появляются новые строки, добавленные другой транзакцией.
---

| Хранилище          | Потенциальные проблемы                   | Решения                                      |
|--------------------|-------------------------------------------|----------------------------------------------|
| **Оперативная память** | Нет изоляции между потоками               | `threading.Lock`, multiprocessing, очереди   |
| **Файлы (JSON, CSV)** | Нет встроенной защиты от параллельной записи | File lock (например, `fcntl`, `portalocker`) |
| **Базы данных**     | Требуется контроль изоляции транзакций    | Использовать транзакции и уровни изоляции    |
